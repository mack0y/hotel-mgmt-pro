<!-- app/templates/bookings.html -->
{% extends "base.html" %}
{% block title %}All Bookings{% endblock %}

{% block content %}
<h1 class="mb-4">üõéÔ∏è All Bookings</h1>

<a href="{{ url_for('routes.book') }}" class="btn btn-primary mb-3">‚ûï New Booking</a>

{% if bookings %}
<table class="table table-striped table-hover">
  <thead class="table-dark">
    <tr>
      <th>Guest</th>
      <th>Room</th>
      <th>Email</th>
      <th>Check-In</th>
      <th>Check-Out</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
  {% for b in bookings %}
  <tr>
    <td>{{ b.guest_name }}</td>
    <td>{{ b.room.room_number }}</td>
    <td>{{ b.guest_email }}</td>
    <td>{{ b.check_in.strftime('%b %d, %Y') }}</td>
    <td>{{ b.check_out.strftime('%b %d, %Y') }}</td>
    <td>
        {{ b.check_in.strftime('%b %d, %Y') }}
        {% set nights = (b.check_out - b.check_in).days %}
        <br><small class="text-muted">{{ nights }} night{{ 's' if nights != 1 else '' }}</small>
    </td>
    <td>
      <form method="POST" action="{{ url_for('routes.cancel_booking', booking_id=b.id) }}" style="display:inline;">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Cancel this booking?')">
            ‚ùå Cancel
        </button>
        </form>
    </td>
  </tr>
  {% endfor %}
</tbody>
</table>
{% else %}
<p class="text-muted">No bookings yet.</p>
{% endif %}

{% endblock %}